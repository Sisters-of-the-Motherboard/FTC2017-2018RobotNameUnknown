package org.firstinspires.ftc.teamcode;

import android.graphics.Color;

import com.qualcomm.robotcore.hardware.DcMotor;
import com.qualcomm.robotcore.hardware.NormalizedColorSensor;
import com.qualcomm.robotcore.hardware.NormalizedRGBA;
import com.qualcomm.robotcore.hardware.Servo;
import com.qualcomm.robotcore.hardware.HardwareMap;
import com.qualcomm.robotcore.hardware.SwitchableLight;
import com.qualcomm.robotcore.util.ElapsedTime;

import org.firstinspires.ftc.robotcore.external.ClassFactory;
import org.firstinspires.ftc.robotcore.external.navigation.RelicRecoveryVuMark;
import org.firstinspires.ftc.robotcore.external.navigation.VuforiaLocalizer;
import org.firstinspires.ftc.robotcore.external.navigation.VuforiaTrackable;
import org.firstinspires.ftc.robotcore.external.navigation.VuforiaTrackables;


public class HardwareOurRobot {

    //Wheels
    public DcMotor leftFront;
    public DcMotor leftBack;
    public DcMotor rightFront;
    public DcMotor rightBack;

    //Glyph operators
    public DcMotor liftMotor;
    public Servo clawOfDoomLeft;
    public Servo clawOfDoomRight;

    //Relic operators
    public DcMotor slideMotor;
    public Servo swingLeft;
    public Servo swingRight;


    //Color Sensor stuff
    public Servo colorServo;
    public NormalizedColorSensor Rainbow;

    //Vuforia
    public static final String TAG = "Vuforia VuMark Sample";
    VuforiaLocalizer vuforia;
    VuforiaTrackables relicTrackables = this.vuforia.loadTrackablesFromAsset("RelicVuMark");
    VuforiaTrackable relicTemplate = relicTrackables.get(0);


    //Timer
    ElapsedTime driveTime = new ElapsedTime();



//---------------------METHODS------------------------------------------


    //Constructor
    public HardwareOurRobot() {

    }

 //---------------------------------INIT--ROBOT------------------------

    public void initializeRobot(HardwareMap HWMap) {

        leftFront = HWMap.dcMotor.get("leftFront");
        leftBack = HWMap.dcMotor.get("leftBack");
        rightFront = HWMap.dcMotor.get("rightFront");
        rightBack = HWMap.dcMotor.get("rightBack");

        liftMotor = HWMap.dcMotor.get("liftMotor");
        clawOfDoomLeft = HWMap.servo.get("clawOfDoomLeft");
        clawOfDoomRight = HWMap.servo.get("clawOfDoomRight");

        slideMotor = HWMap.dcMotor.get("slideMotor");
        swingLeft = HWMap.servo.get("swingLeft");
        swingRight = HWMap.servo.get("swingRight");

        colorServo = HWMap.servo.get("colorServo");

        Rainbow = HWMap.get(NormalizedColorSensor.class, "Rainbow");

        leftFront.setDirection(DcMotor.Direction.REVERSE);
        leftBack.setDirection(DcMotor.Direction.REVERSE);
        rightFront.setDirection(DcMotor.Direction.FORWARD);
        rightBack.setDirection(DcMotor.Direction.FORWARD);

        /*
                SET SERVO INIT VALUES CORRECTLY
         */

        clawOfDoomLeft.setPosition(0.5);
        clawOfDoomRight.setPosition(0.5);
        colorServo.setPosition(0.4);
        swingLeft.setPosition(0.5);
        swingRight.setPosition(0.5);



    }

//-------------------------------INIT--COLOR--SENSOR----------------------------


    public void initializeColorSensor(HardwareMap HWMap) throws InterruptedException {

        // turn the light on
        if (Rainbow instanceof SwitchableLight) {
            ((SwitchableLight) Rainbow).enableLight(true);
        }


    }

//---------------------------------INIT--VUFORIA----------------------------------


    public void initializeVuforia(HardwareMap HWMap){

        int cameraMonitorViewId = HWMap.appContext.getResources().getIdentifier("cameraMonitorViewId",
                "id", HWMap.appContext.getPackageName());

        VuforiaLocalizer.Parameters parameters = new VuforiaLocalizer.Parameters(cameraMonitorViewId);

        parameters.vuforiaLicenseKey =
                "AddfCmL/////AAAAGfhZdqZawEPNnf6i6NP5bBJnbxm51Vv6Ic543cGLSFZRXzcCLKL8Dz/UCbHG7kVdxhx3dkMGRdopyfekAowHmlslyP5m3pZkhDaGrzdVyZZnVV7rho4mjaUSBQJhx6plhZyFPPK6q7+7xcdFXRhSpOXtRTU3tjVQOFbA2B9uuRGheb1HeidRDvhS/856blHK3Wv +PmeJBgZIrPkGOrLPDsyUqQtFZxKnn65Yce43u0wcs/dbn0ssr+bvvqp1Q4JKJrm2XnzwmtqNd0PZHO6hxHzyaxC5ge +aExWcSEM72yE8d1DznHQ/s5wYRJpVaAss7/F885CTL0zB+Pzcb3wfuG93rlIQE8coMcmqrk+tmuHH";


        parameters.cameraDirection = VuforiaLocalizer.CameraDirection.FRONT;

        this.vuforia = ClassFactory.createVuforiaLocalizer(parameters);


        relicTemplate.setName("relicVuMarkTemplate");



    }


//--------------------------OPEN--AND--CLOSE--CLAWS---------------------------------


  /*  public void openTheCLAWS(){
        clawOfDoomLeft.setPosition(0.8);

        clawOfDoomRight.setPosition(0.2);
    }


    public void  closeTheCLAWS(){
        clawOfDoomLeft.setPosition(1.0);

        clawOfDoomRight.setPosition(0.0);
    }


//-------------------------DRIVE--BY--TIME-----------------------------------------------


    public void driveByTime(double powerL, double powerR, double mSec){ //For driving

        driveTime.reset();

        while (driveTime.milliseconds() <= mSec ) {

            leftFront.setPower(powerL);
            leftBack.setPower(powerL);

            rightFront.setPower(powerR);
            rightBack.setPower(powerR);
        }

        leftFront.setPower(0.0);
        leftBack.setPower(0.0);
        rightFront.setPower(0.0);
        rightBack.setPower(0.0);

    }

//---------------------------GRAB--AND--LIFT--GLYPH------------------------------------------

    public void grabAndLiftGlyph(){

        openTheCLAWS();

        driveTime.reset();
        while (driveTime.milliseconds() <= 500){

        }

        closeTheCLAWS();

        driveTime.reset();
        while(driveTime.milliseconds() <= 500) {

            liftMotor.setPower(-0.3);
        }

        liftMotor.setPower(0.0);

    }


//--------------------------------------LOWER--GLYPH-----------------------------------------


    public void lowerGlyph(){

        driveTime.reset();
        while(driveTime.milliseconds() <= 500){

            liftMotor.setPower(0.3);

        }

        liftMotor.setPower(0.0);

    }

//-------------------------SENSE--COLOR-----------------------------------------------------


    public String senseColor(){

        String returnColor = "";

        for(int i = 0; i <= 5; i++) {
            // Read the sensor
            NormalizedRGBA colors = Rainbow.getNormalizedColors();

            int color = colors.toColor();

            float max = Math.max(Math.max(Math.max(colors.red, colors.green), colors.blue), colors.alpha);
            colors.red /= max;
            colors.green /= max;
            colors.blue /= max;
            color = colors.toColor();


            if (colors.red >= .40) {

                returnColor = "RED";

            } else if (Color.BLUE >= .40) {

                returnColor = "BLUE";

            }
            else {
                returnColor = "NONE";
            }

        }


        return returnColor;

    }


//-------------------------READ--VUFORIA---------------------------------


    public String readVuforia(){

        relicTrackables.activate();
        RelicRecoveryVuMark vuMark = RelicRecoveryVuMark.from(relicTemplate);

        String picOrientation = "NONE";

        if (vuMark == RelicRecoveryVuMark.LEFT) {
            // Test to see if Image is the "LEFT" image and display value.

            picOrientation = "LEFT";


        }
        else if (vuMark == RelicRecoveryVuMark.RIGHT) {
            // Test to see if Image is the "RIGHT" image and display values.


            picOrientation = "RIGHT";


        }
        else if (vuMark == RelicRecoveryVuMark.CENTER) {
            // Test to see if Image is the "CENTER" image and display values.

            picOrientation = "CENTER";


        }



        return picOrientation;

    }


*/

}
